.row
  %table
    %thead
      %tr
        %th #
        %th name
        %th admin?
        %th sent
        -@relays.each do |relay|
          %th[relay]{class: "#{relay.frozen ? "frozen" : ''} #{relay.closed ? 'closed' : ''} #{relay.moderated ? 'moderated' : ''}"}
            .name=relay.name
            .number=relay.number
            -if relay.frozen
              (frozen)
            -if relay.closed
              (closed)
            -if relay.moderated
              (moderated)
    %tbody
      -@subscribers.each do |subscriber|
        %tr[subscriber]{class: subscriber.admin ? "admin" : ""}
          %td=subscriber.number
          %td=subscriber.name_or_anon
          %td=subscriber.admin? ? check : cross
          %td.sent=subscriber.sent.count
          -@relays.each do |relay|
            -if relay.subscribed?(subscriber)
              -frozen = relay.frozen
              -muted = relay.subscription_for(subscriber).muted
              -voiced = relay.subscription_for(subscriber).voiced
              %td{class: "relay_#{relay.id} subscriber_#{subscriber.id} #{muted ? 'muted' : ''} #{frozen ? 'frozen' : ''} #{voiced ? 'voiced' : ''}"}
                =check
                -if muted
                  (muted)
                -if voiced
                  (voiced)
            -else
              %td
